# ************************************
# Managed by Puppet
# ************************************

<VirtualHost *:80>
#  ServerName <%= @vhost_name %>
#  DocumentRoot <%= @docroot %>
#  <Directory <%= @docroot %>>
#    Options Indexes FollowSymLinks MultiViews
#    AllowOverride None
#    AllowOverrideList Redirect RedirectMatch
#    Satisfy Any
#    Require all granted
#  </Directory>
#  LogLevel warn
#  ErrorLog /var/log/apache2/<%= @vhost_name %>_error.log
#  CustomLog /var/log/apache2/<%= @vhost_name %>_access.log combined
#  ServerSignature Off
#  Redirect permanent / https://<%= @vhost_name %>/
#</VirtualHost>
#
#<VirtualHost *:443>
  ServerName <%= @vhost_name %>
  DocumentRoot <%= @docroot %>
  <Directory <%= @docroot %>>
    Options Indexes FollowSymLinks MultiViews
    AllowOverride None
    AllowOverrideList Redirect RedirectMatch
    Satisfy Any
    Require all granted
  </Directory>
  LogLevel warn
  ErrorLog /var/log/apache2/ssl-<%= @vhost_name %>_error.log
  CustomLog /var/log/apache2/ssl-<%= @vhost_name %>_access.log combined
  ServerSignature Off

  <Location "/api">
    AuthType basic
    AuthName "private area"
    AuthUserFile "/etc/apache2/htpasswd"
    Order allow,deny
    Allow from all
    Require valid-user
  </Location>

  RewriteEngine  on
  RewriteRule    "^/api/(.*)$"  "http://localhost:8080/api/$1"  [P]
  #ProxyPass /aptly http://localhost:8080/

#  SSLEngine on
#  SSLProtocol All -SSLv2 -SSLv3
#  SSLCipherSuite ECDH+AESGCM:DH+AESGCM:ECDH+AES256:DH+AES256:ECDH+AES128:DH+AES:RSA+AESGCM:RSA+AES:!AES256:!aNULL:!eNULL:!MD5:!DSS:!PSK:!SRP
#  SSLHonorCipherOrder on
#  SSLCertificateFile <%= @cert_file %>
#  SSLCertificateKeyFile <%= @key_file %>
</VirtualHost>
